<p><strong>North Korean state-sponsored <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/hacker'>hacking</a> group Lazarus has started targeting individuals and organizations directly, instead of focusing exclusively on spying on financial institutions, <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Proofpoint'>Proofpoint</a> reports.</strong></p>
<p>Active since at least 2009, the Lazarus Group is considered one of the most <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/disruptive technology'>disruptive</a> nation-state sponsored actors, accused of being involved in numerous high-profile <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/cyberattack'>attacks</a>. Some of these include the 2014 <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Sony Pictures hack'>Sony Pictures hack</a>, last year’s theft of <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Bangladesh Bank robbery'>$81 million from the Bangladesh Bank</a>, and this year’s <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/WannaCry ransomware attack'>WannaCry ransomware attack</a>.</p>
<p>The group was recently observed to be increasingly focused on financially motivated <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/cyberattack'>attacks</a> and was named as the most serious threat against banks earlier this year. More recently, the group also started showing high interest in the skyrocketing prices of cryptocurrencies.</p>
<p>The multistage <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/cyberattack'>attacks</a> that <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Proofpoint'>Proofpoint</a> has uncovered rely on cryptocurrency-related lures to spread sophisticated <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/backdoor'>backdoors</a> and reconnaissance <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Malware'>malware</a>. In some cases, the <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/hacker'>hackers</a> deploy additional <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Malware'>malware</a>, including <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Gh0st RAT'>the Gh0st remote access Trojan (RAT)</a>, in an attempt to steal credentials for cryptocurrency wallets and exchanges.</p>
<p>What’s more, <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Proofpoint'>Proofpoint</a>'s security researchers discovered that the nation-state actor also started targeting a <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/point of sale'>point-of-sale</a> (<a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/point of sale'>PoS</a>) related framework to steal credit card data. These <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/point of sale'>PoS</a> <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/cyberattack'>attacks</a> can potentially incur high financial losses given their timing near the holiday shopping season.</p>
<p>In a new report (PDF), <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Proofpoint'>Proofpoint</a> details a new toolset associated with the Lazarus Group. Dubbed <strong><a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerRatankba'>PowerRatankba</a></strong>, the toolset has been targeting individuals, companies, and organizations with interests in cryptocurrency via spear-<a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/phishing'>phishing</a> and <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/phishing'>phishing</a> campaigns.</p>
<p>The <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/hacker'>hackers</a> were observed using a total of six different <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/cyberattack'>attack</a> vectors to deliver <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerRatankba'>PowerRatankba</a>, including a new Windows executable downloader called <em>PowerSpritz</em>, a malicious Windows Shortcut (<a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/LNK'>LNK</a>) file, malicious <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Microsoft Compiled HTML Help'>Compiled HTML Help (CHM) files</a>, <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/JavaScript'>JavaScript</a> (<a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/JavaScript'>JS</a>) downloaders, two macro-based Microsoft Office documents, and <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/backdoor'>backdoored</a> popular cryptocurrency applications hosted on internationalized domain (IDN) infrastructure, thus appearing as legitimate.</p>
<p>The campaigns started on or around June 30, 2017 and included highly targeted spear-<a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/phishing'>phishing</a> <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/cyberattack'>attacks</a> focused on at least one executive at a cryptocurrency organization. While a <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerRatankba'>PowerRatankba</a>.A variant was used in these <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/cyberattack'>attacks</a>, the rest of the campaigns used <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerRatankba'>PowerRatankba</a>.B, <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Proofpoint'>Proofpoint</a> says.</p>
<p><strong><a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/cyberattack'>Attack</a> vectors</strong></p>
<p>The PowerSpritz downloader hides both its legitimate <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/payload'>payload</a> and malicious <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerShell'>PowerShell</a> command using the Spritz encryption algorithm. The downloader has been delivered via spear-<a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/phishing'>phishing</a> <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/cyberattack'>attacks</a> using the TinyCC link shortener service to hide the malicious link.</p>
<p>Posing as Telegram or Skype updates, PowerSpritz would first launch a legitimate installer to trick the user into believing they downloaded a working application installer or update. In the background, however, a <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerShell'>PowerShell</a> command is executed to download the first stage of <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerRatankba'>PowerRatankba</a>.</p>
<p>A malicious <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/LNK'>LNK</a> file was observed using a known AppLocker bypass to retrieve the <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/payload'>payload</a> from a TinyURL shortener link. The CHM files abuse a well-known technique to create a shortcut object capable of executing malicious code and to cause the object to be automatically clicked.</p>
<p>The <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/JavaScript'>JavaScript</a> (<a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/JavaScript'>JS</a>) downloaders are hosted on supposedly <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/cyberattack'>attacker</a>-controlled servers and have been designed to retrieve decoy PDF documents featuring themes such as cryptocurrency exchanges Coinbase and Bithumb, the Falcon Coin ICO, and a list of <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Bitcoin'>Bitcoin</a> transactions.</p>
<p>The researchers also associated two VBScript macro-laden Microsoft Office documents with this activity, namely one Word document and one Excel spreadsheet. The former uses an Internal Revenue Service (IRS) theme, while the latter uses a Bithumb lure.</p>
<p><strong>New first-stage implant</strong></p>
<p>Recent <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/cyberattack'>attacks</a> involved the use of <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/phishing'>phishing</a> emails to direct users to fake webpages in an attempt to trick them into downloading or updating cryptocurrency applications. A <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/backdoor'>backdoor</a> in the <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PyInstaller'>PyInstaller</a> executables, however, was meant to download <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerRatankba'>PowerRatankba</a>.</p>
<p>The implant, supposedly a successor of Ratankba, which was publicly detailed earlier this year, is a first stage reconnaissance tool used for the deployment of further stage implants. Using <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Hypertext Transfer Protocol'>HTTP</a> for command and control (C&amp;C) communication, <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerRatankba'>PowerRatankba</a> first sends information about the machine, including computer name, <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/IP address'>IP address</a>, OS <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/boot time'>boot time</a> and installation date, language, info on ports 139/3389/445, a process list, and output from two <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/WMIC'>WMIC</a> commands (<a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerRatankba'>PowerRatankba</a>.B only).</p>
<p>After initial contact with the C&amp;C, <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerRatankba'>PowerRatankba</a>.A sends a request to receive commands from the server. This <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Malware'>malware</a> variant can download a <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/payload'>payload</a> and execute it via memory injection; can download the <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/payload'>payload</a>, save it to disk, and then execute it; can sleep and send request after sleep; and exit.</p>
<p>For persistence, <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerRatankba'>PowerRatankba</a>.A saves a <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/JavaScript'>JS</a> file to the Startup folder. Depending on whether it runs under an admin account or not, <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerRatankba'>PowerRatankba</a>.B either downloads a <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerShell'>PowerShell</a> script, saves it to disk, and creates a scheduled task to execute it on system startup, or downloads a VBScript file and saves it to the Startup folder.</p>
<p><a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerRatankba'>PowerRatankba</a>.B was observed delivering a custom variant of the Gh0st RAT to several devices, but only to victims with obvious interest in cryptocurrencies. An <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/cyberattack'>attack</a> involving the RAT revealed immediate interest in taking full remote control of the infected device to interact with a password-protected <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Bitcoin'>Bitcoin</a> wallet, among other applications.</p>
<p><strong><a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/point of sale'>POS</a> <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Malware'>malware</a></strong></p>
<p>The North Korean state-sponsored <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/hacker'>hackers</a> appear to be interested in other financially motivated actions as well, beyond stealing millions in <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/cryptocurrency'>cryptocurrency</a>. Thus, <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Proofpoint'>Proofpoint</a> has discovered what appears to be a Lazarus operation focused on targeting <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/point of sale'>PoS</a> terminals of businesses operating in South Korea.</p>
<p>Dubbed <strong>RatankbaPOS</strong>, this might be “the first publicly documented nation-state sponsored campaign to steal <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/point of sale'>PoS</a> data from a <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/point of sale'>PoS</a>-related framework,” the security researchers note.</p>
<p>Although it’s unclear how the new <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Malware'>malware</a> variant is distributed, <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Proofpoint'>Proofpoint</a> believes that <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/PowerRatankba'>PowerRatankba</a> is used to deploy later stage implants that would ultimately infect systems with RatankbaPOS. The file was found on a C&amp;C in plaintext, suggesting that it wasn’t deployed using the reconnaissance tool.</p>
<p>Deployment is achieved through a <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/process injection'>process injection</a> dropper that can also achieve persistence by creating a registry key. The <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Malware'>malware</a> first checks with the server for an update and then starts the <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/process injection'>process injection</a> search.</p>
<p>RatankbaPOS would hook a KSNETADSL.dll module “which appears to be the handling of encrypted and decrypted credit card numbers for a KSNET-related <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/point of sale'>POS</a> framework system.” According to <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Proofpoint'>Proofpoint</a>, however, the module (two of them, actually) isn’t the correct target for the <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Malware'>malware</a>.</p>
<p>The security researchers believe that the <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/Malware'>malware</a> might be targeting an encrypted form of the track data, suggesting that the actor is focused on a SoftCamp <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/point of sale'>POS</a>-related software application, framework, or device. The researchers believe “with high confidence” that the <a class='wikiPreview' href='#' data-wiki-lang='en' data-wiki-title='json_evaluation/cyberattack'>attacks</a> are primarily targeting devices in South Korea.</p>

